To run normally, just use:

ruby cdh.rb

To run a socket server, use:

ruby server_cdh.rb